language: generic
sudo: enabled

install:
  # install plash
  - sudo apt-get install python3 python3-pip
  - sudo pip3 install plash

#cache:
#  directories:
#    - ~/plashdata/mydata.tar

git:
  depth: 1

env:
  - BUILD="--alpine python3 bash"
  - BUILD="--ubuntu python3"
  - BUILD="--fedora pyp3 --run 'ln -fs /usr/bin/pypy3 /usr/bin/python3'"

script:
  - sudo plash-init
  - sudo plash-build $BUILD
  - sudo plash-run $BUILD --layer --devinit -- sh -c 'ln -s $(mktemp -d) /var/lib/plash && misc/runtests'
