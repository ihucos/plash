#!/usr/bin/env python3
#
# usage: plash-rm [CONTAINER1 [CONTAINER2 [CONTAINER3 ...]]]
# Deletes the given containers.

from subprocess import CalledProcessError, check_output
import os
import sys
from shutil import rmtree
from tempfile import mkdtemp
from plashlib.utils import catch_and_die, handle_build_args, handle_help_flag, nodepath_or_die
from plashlib import ux

handle_help_flag()
handle_build_args()
ux.assert_is_root()

PLASH_DATA = os.environ.get('PLASH_DATA', '/var/lib/plash')

for container in sys.argv[1:]:
    node = nodepath_or_die(container)
    tmp = mkdtemp(dir=PLASH_DATA)
    os.rename(node, tmp)
    rmtree(tmp)
