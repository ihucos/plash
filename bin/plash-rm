#!/bin/sh

# usage: plash rm [CONTAINER1 [CONTAINER2 [CONTAINER3 ...]]]
# Deletes the given containers.

set -e

test "$*" == --help && exec plash-help rm

plash_data="${PLASH_DATA:-/var/lib/plash}"
for container in "$@"
do
  node=$(plash-nodepath $container)
  tmpd=$(mktemp -d $plash_data/tmp/XXXXXXXXXXXX)
  mv $node $tmpd
  rm "$plash_data/links/$container"
  rm -rf $tmpd
done
